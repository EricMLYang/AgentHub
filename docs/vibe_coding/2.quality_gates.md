---
name: 對於 Coding Agent 產出有嚴格的把關
description: 讓 Coding Agent 產出持續保持在好的軌道的把關機制研究筆記
---
**嚴格品質門檻（Quality Gates）：**建立自動化的品質檢查機制，任何 AI 產出的代碼變更都必須通過一系列 gate 才能進入正式環境。例如：(a) 所有自動化測試綠燈（單元、整合測試）；(b) linter靜態分析無重大違規；(c) 代碼安全掃描無高危漏洞（SAST、依賴漏洞掃描等）；(d) 無暴露敏感資訊或金鑰（Secrets Scanning）。可以在CI中配置這些檢查，只要未通過就在PR標記拒絕。**系統思考：**品質門檻相當於在AI輸出與生產環境間加裝“控制閥”。確保不符合團隊品質標準的輸出絕不會流入下游，形成有效的負反饋約束。


## 嚴格品質門檻（Quality Gates / CI 控制閥）
### 典型負責角色（誰的任務）
1. 主責（Owner）
* Tech Lead / Engineering Manager（在小 team 常是同一人）：決定品質政策與風險等級（哪些 gate 必須擋 PR）。
* DevOps / Platform Engineer：把 policy 落到 CI/CD、分支保護、權限與環境。

2. 共同參與（Co-owner）
* QA / Test Engineer：測試策略、測試金字塔、測試資料、測試穩定性。
* Security / AppSec（若有）：SAST、依賴漏洞、secret scanning 的基線與例外流程。

3. 所有工程師共同責任（Everyone owns it）
只要是 gate 的項目，工程師要維護它不要爛掉：測試要補、lint 要修、依賴要更新。

### 一般開發者要怎麼精通
這裡的「精通」不是會按按鈕，而是：你能設計出不拖慢速度、又能擋住風險的 gate。

必練 5 個技能：

1. 測試工程（不是只會寫單元測試）
* 單元 vs 整合 vs E2E 什麼時候該用哪個
* 測試要穩（避免 flaky），不然 gate 會被團隊討厭、最後被關掉

2. CI 思維（可重現、可快、可觀測）
* pipeline 分層：快的先跑（lint/unit），慢的後跑（integration/e2e）
* 有 cache、並行、fail-fast，避免每次 PR 等 30 分鐘

3. 靜態分析與程式品質
* linter / formatter / type check 的價值與設定策略（嚴格到能提高品質，但不至於每天卡死）
* 會處理「例外」：例如 legacy code 的 gradual tightening

4. 安全基礎（供應鏈 + secrets + 常見漏洞）
* 你不用成為資安專家，但要懂：為什麼依賴漏洞、secret 會被 gate 擋
* 以及怎麼修：pin 版本、升級策略、移除 hardcode、用 vault/環境變數

5. 品質政策設計能力（risk-based gates）
* 不是所有 PR 都一樣嚴格
你要會分級：例如「改 auth / billing」→ 更嚴，「改文案」→ 輕量 gate

6. 最快的精通路徑（很適合工程師）：
先成為「你們 repo 的 CI 維修工」1–2 個月：
任何 CI fail 你都去看原因、加速、修 flaky、補缺失。
你會快速理解 gate 的本質與最佳設定。