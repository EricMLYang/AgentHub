# [Idea] 自動化數據分析報告 Agent

## 😫 痛點（現在多煩）

每次產出數據分析報告都需要：
- 手動從 Databricks 撈數據、計算指標
- 整理成結構化報告（概況、環比同比、異常、洞察）
- 重複寫類似的敘事與說明
- 需要在不同渠道發佈（Slack / Email / Confluence）
- 缺少版本管理與審計紀錄

整個流程耗時且容易遺漏重要洞察或數據來源引用。

## 👤 目標使用者（誰會用）

- 數據分析師/BI 團隊：需要定期產出分析報告
- 產品經理/業務團隊：需要定期接收業務洞察
- 管理層：需要快速了解關鍵指標與異常

## 📥 輸入（Input）

- Databricks Gold Table / 指標數據
- 歷史報告（原子化儲存）
- 指標定義文件（PRD / 儀表板說明）
- 報告排程設定（日/週/月）
- 目標渠道設定（Slack / Email / Confluence）

## 📤 輸出（Output）

- **結構化分析報告**（Markdown / PDF / HTML）
  - 當期概況
  - 環比/同比分析
  - 細分貢獻度
  - 異常與風險提示
  - 洞察與行動建議
  - 需澄清事項
  - 數據來源引用
- 排程自動產出並發佈
- 報告版本與審計紀錄

## ✅ 驗收方式（Acceptance Criteria）

- [ ] 報告包含所有必要章節（概況、環比、細分、異常、洞察、來源）
- [ ] 數值與來源數據一致（對帳檢核通過）
- [ ] 所有數據引用必須標註來源
- [ ] 異常超過閾值時會自動標記並說明
- [ ] 按時產出（準時率 > 95%）
- [ ] 洞察與行動建議段落需經人工審核（HITL）
- [ ] 可產生報告 diff，比對與上期差異

## ⚠️ 風險/限制

- **敘事幻覺**：LLM 可能產生不符事實的敘述 → 需要 RAG + 強制引用規則
- **來源引用不嚴謹**：缺少明確的數據溯源 → 實作引用完整性檢查
- **洞察品質難量化**：好壞需要人評估 → 採用「草稿→審核→發佈」流程（HITL）
- 需要存取 Databricks 與歷史報告的權限

## 💭 其他補充

**Agent 化適配評分（1-5）**：
- 規則明確性：4（章節固定、格式可規範）
- 可驗證性：4（一致性檢查、引用完整性、數值對齊）
- 回饋延遲：2-3（洞察好壞需人評，但格式/數值可秒級驗證）
- 資料可得性：5（數據、歷史報告、指標定義都存在）
- KPI 清楚：5（準時率、錯誤率、人工省時）
- 風險：2（錯誤可控、可加審核）
- **總評：4/5（高 ROI）**

**選型建議**：Workflow + RAG 為主；「部分 Agent」為輔
- 報告產出流程是固定步驟（取數→算指標→產出），用 Workflow 最穩
- LLM 的價值在敘事一致性與可讀性，用 RAG 讓用語與定義一致
- 真正 Agent 只放在「異常診斷/追因」等需要多步推理的段落

**7 類型定位**：Analytics Agent（主）+ Business-task Agent（排程/發佈）
